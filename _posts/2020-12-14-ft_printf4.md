---
layout: single
title: "[ft_printf] 간단한 printf 함수 만들어보기"
categories: "ft_printf"
tags: [ft_printf, C]
---

먼저 우리에게 허용된 함수는 `malloc, free, write, va_start, va_arg, va_copy, va_end`, 그리고 `libft의 함수들`이다.  
libft에 포함되어 있는 함수들은 아래의 libft 관련 포스트를 참고하자.

<a href="https://kitkat-42.github.io/libft/first-post/">Libft part1 함수(memset~strdup)</a>  
 <a href="https://kitkat-42.github.io/libft/second-post/">Libft part2, bonus 함수(substr~ft_lstmap)</a>

참고로 libft의 출력 함수들은

- putchar - 문자 출력
- putstr - 스트링 출력
- putendl - 스트링 줄바꿈 출력
- putnbr - 정수 출력

정도가 있다.

우선, 다른 형식 지정자들은 제외하고 `%c`, `%d`, `%s`와 같은 `서식 지정자`만 가능하게 만들어보자.

# 함수의 원형

printf 함수처럼 가변 인자를 사용해야 하고, 첫 번째 인수로 `형식 지정자 문자열`을 받을 수 있게 다음과 같이 준비한다. 프로젝트 소개에도 제시되어있는 함수 원형이다.

```c
int ft_printf(const char *, ...)
{

}
```

# 변수 선언

`%c`와 `%d`는 가변 인수로 전달된 값을 정수로 받을 것이기 때문에 int_data라는 변수를 선언하였다. %c는 문자를 출력하는 서식 지정자이지만 문자도 결국 ASCII 코드 값(정수값)으로 전달되기 때문에 정수로 처리하면 된다.

`%s`는 문자열의 시작 주소를 사용하기 때문에 char \* 형식의 포인터를 선언하였다. 그리고 가변 인수를 처리하기 위해서 va_list 자료형의 변수도 선언하였다.

```c
int	ft_printf(const char *format, ...)
{
	int		int_data;		// %c, %d에서 사용할 변수
	char	*p_string;		// %s에서 사용할 변수
	va_list	ap;				// 현재 처리할 가변 인수의 위치(argument point)를 가리키는 변수
}
```

# 형식 지정자 문자열 처리

`%c`, `%d`, `%s`와 같은 형식만 처리하게끔 만드는 것이므로 '형식 지정자' 문자열에서 NULL 문자가 나올 때까지 탐색하면서 **현재 문자가 '%'문자인지 체크해서 '%'가 아니면 해당 문자열을 그냥 출력하고 '%'이면 그 다음 문자에 따라 작업을 진행**하게 하면 된다.

```c
int	ft_printf(const char *format, ...)
{
	int		int_data;
	char	*p_string;
	va_list	ap;

	// 첫번째 가변 인수의 위치를 마지막 고정 인수를 가지고 결정한다.
	va_start(ap, format);
}
```
